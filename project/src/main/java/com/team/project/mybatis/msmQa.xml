<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper      
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"      
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="msmQa">
    <!-- qa 페이지에서 리스트를 불러올때 -->
    <select id="qalist" parameterType="String" resultType="msmQaVo">
        select * from qa
        <!--where qusNum=#{_parameter} where문을 뺴면 데이터가 나옴-->
        order by qusNum desc <!--정렬 빼도 됨-->
    </select>

    <!-- qaview 페이지에서 자세한 내용을 볼때 -->
    <select id="qaView" parameterType="Integer" resultType="msmQaVo">
        select * from qa
        where qusNum = #{qusNum}
    </select>

    <!-- qa 페이지에서 검색창을 이용해 리스트를 불러올때-->
    <select id="search" parameterType="String" resultType="msmQaVo">
        select qusNum, qusId, qusTitle, qusDate
        from qa
        where qusTitle like concat('%', #{findStr}, '%')
    </select>

    <!-- question 페이지에서 작성 버튼을 눌렀을때 적힌 데이터를 저장할때-->
    <insert id="saveQuestion" parameterType="String">
        insert into qa(qusId, qusCon, qusDate, qusTitle, qusNum)
        values(#{qusId}, #{qusCon}, now(), #{qusTitle}, #{qusNum})
    </insert>
    
    <!-- answer 페이지에서 작성 버튼을 눌렀을때 적힌 데이터를 저장할때-->
    <insert id="saveAnswer" parameterType="msmQaVo">
        insert into qa (ansCon, ansDate)
        values (#{ansCon}, now());
    </insert>

    <!-- question, answer 둘 다 삭제 하기-->
    <delete id="delete" parameterType="String">
        delete from qa where qusNum=#{qusNum}
    </delete>

    <!--insert 부분에 answer관련 데이터까지 싹다 받은 후 update를 통해 수정할 예정-->
<!-- 7.10 추가
    <insert id="saveQuestion" parameterType="msmQaVo">
        insert into qa (qusId, qusCon, qusDate, qusTitle, qusNum)
        values (#{qusId}, #{qusCon}, NOW(), #{qusTitle}, #{qusNum});
        
        answer 관련 데이터 추가
        insert into qa (qusNum, ansCon, ansDate)
        values (#{qusNum}, NULL, NULL);
    </insert>
    
    답변 수정
    <update id="updateAnswer" parameterType="msmQaVo">
        update qa set ansCon = #{ansCon}, ansDate = NOW()
        WHERE qusNum = #{qusNum};
    </update>
-->
</mapper>