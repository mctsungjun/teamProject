<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper      
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"      
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="project">
    <select id="purchase_search" parameterType="String" resultType="PurchaseVo">
        select * from purchase
        where productCode like '%${findStr}%'
        or productName like '%${findStr}%'
        or price like '%${findStr}%'
        or nal like '%${findStr}%'
    </select>
    <select id="purchase_view" parameterType="Integer" resultType="PurchaseVo">
        select * from purchase
        where no=#{_parameter}
    </select>
    <select id="purchase_list" parameterType="Integer" resultType="PurchaseVo">
        select no, productCode, productName, price, ea, nal, customer from purchase
        where no=#{_parameter}
    </select>
    <update id="purchase_modify" parameterType="PurchaseVo">
        update purchase set ea=#{ea}
        where no=#{no}
    </update>

    <!--_______________product______________-->
    <select id="product_search" parameterType="String" resultType="ProductVo">
        select productName, comment, price from product
        where productName like '%${findStr}%'
        or comment like '%${findStr}%'
    </select>
    <select id="product" parameterType="String" resultType="ProductVo">
        select productName, explanation, price
        where productName=#{_parameter}
    </select>
    <select id="product_view" parameterType="String" resultType="ProductVo">
        select productName from product
        where productName=#{_parameter}
    </select>
    <select id="photos" parameterType="String" resultType="ojw_PhotoVo">
        select no, photo, oriPhoto from product_photos
        where no=#{_parameter}
    </select>
    <insert id="product_register" parameterType="Map">
        insert into product(productName, productCode, price, spec, comment, explanation, photo)
        values(#{productName}, #{productCode}, #{price}, #{spec}, #{comment}, #{explanation}, #{photo})

        <if test="photos != null">
            insert into product_photos(no, oriPhoto, photo) values
            <foreach collection="photos" item="p" separator=",">
                (#{no}, #{p.oriPhoto}, #{p.photo})
            </foreach>
        </if>
    </insert>
</mapper>